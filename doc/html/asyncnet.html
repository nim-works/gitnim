<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>asyncnet</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);

  const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
  if (currentTheme) {
    document.documentElement.setAttribute('data-theme', currentTheme);

    if (currentTheme === 'dark') {
      toggleSwitch.checked = true;
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">asyncnet</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple-boot">
      <li>
        <a href="manual.html">Manual</a>
      </li>
      <li>
        <a href="lib.html">Standard library</a>
      </li>
      <li>
        <a href="theindex.html">Index</a>
      </li>
      <li>
        <a href="compiler/theindex.html">Compiler docs</a>
      </li>
    </ul>
  </div>
  <div id="searchInputDiv">
    Search: <input type="text" id="searchInput"
      onkeyup="search()" />
  </div>
  
  <ul class="simple simple-toc" id="toc-list">
<li><a class="reference" id="asynchronous-io-in-nim_toc" href="#asynchronous-io-in-nim">Asynchronous IO in Nim</a></li>
<li><a class="reference" id="examples_toc" href="#examples">Examples</a></li>
<ul class="simple"><li><a class="reference" id="examples-chat-server_toc" href="#examples-chat-server">Chat server</a></li>
</ul><li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#AsyncSocket"
    title="AsyncSocket = ref AsyncSocketDesc"><wbr />Async<wbr />Socket<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#newAsyncSocket%2CAsyncFD%2CDomain%2CSockType%2CProtocol"
    title="newAsyncSocket(fd: AsyncFD; domain: Domain = AF_INET;
               sockType: SockType = SOCK_STREAM; protocol: Protocol = IPPROTO_TCP;
               buffered = true; inheritable = defined(nimInheritHandles)): owned(
    AsyncSocket)"><wbr />new<wbr />Async<wbr />Socket<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#newAsyncSocket%2CDomain%2CSockType%2CProtocol"
    title="newAsyncSocket(domain: Domain = AF_INET; sockType: SockType = SOCK_STREAM;
               protocol: Protocol = IPPROTO_TCP; buffered = true;
               inheritable = defined(nimInheritHandles)): owned(AsyncSocket)"><wbr />new<wbr />Async<wbr />Socket<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#getLocalAddr%2CAsyncSocket"
    title="getLocalAddr(socket: AsyncSocket): (string, Port)"><wbr />get<wbr />Local<wbr />Addr<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#getPeerAddr%2CAsyncSocket"
    title="getPeerAddr(socket: AsyncSocket): (string, Port)"><wbr />get<wbr />Peer<wbr />Addr<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#newAsyncSocket%2Ccint%2Ccint%2Ccint"
    title="newAsyncSocket(domain, sockType, protocol: cint; buffered = true;
               inheritable = defined(nimInheritHandles)): owned(AsyncSocket)"><wbr />new<wbr />Async<wbr />Socket<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#dial%2Cstring%2CPort"
    title="dial(address: string; port: Port; protocol = IPPROTO_TCP; buffered = true): owned(
    Future[AsyncSocket])"><wbr />dial<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#connect%2CAsyncSocket%2Cstring%2CPort"
    title="connect(socket: AsyncSocket; address: string; port: Port): owned(Future[void])"><wbr />connect<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recvInto%2CAsyncSocket%2Cpointer%2Cint"
    title="recvInto(socket: AsyncSocket; buf: pointer; size: int; flags = {SafeDisconn}): owned(
    Future[int])"><wbr />recv<wbr />Into<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recv%2CAsyncSocket%2Cint"
    title="recv(socket: AsyncSocket; size: int; flags = {SafeDisconn}): owned(Future[string])"><wbr />recv<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#send%2CAsyncSocket%2Cpointer%2Cint"
    title="send(socket: AsyncSocket; buf: pointer; size: int; flags = {SafeDisconn}): owned(
    Future[void])"><wbr />send<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#send%2CAsyncSocket%2Cstring"
    title="send(socket: AsyncSocket; data: string; flags = {SafeDisconn}): owned(Future[void])"><wbr />send<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#acceptAddr%2CAsyncSocket"
    title="acceptAddr(socket: AsyncSocket; flags = {SafeDisconn};
           inheritable = defined(nimInheritHandles)): owned(
    Future[tuple[address: string, client: AsyncSocket]])"><wbr />accept<wbr />Addr<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#accept%2CAsyncSocket"
    title="accept(socket: AsyncSocket; flags = {SafeDisconn}): owned(Future[AsyncSocket])"><wbr />accept<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recvLineInto%2CAsyncSocket%2CFutureVar%5Bstring%5D"
    title="recvLineInto(socket: AsyncSocket; resString: FutureVar[string];
             flags = {SafeDisconn}; maxLength = MaxLineLength): owned(Future[void])"><wbr />recv<wbr />Line<wbr />Into<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recvLine%2CAsyncSocket"
    title="recvLine(socket: AsyncSocket; flags = {SafeDisconn}; maxLength = MaxLineLength): owned(
    Future[string])"><wbr />recv<wbr />Line<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#listen%2CAsyncSocket"
    title="listen(socket: AsyncSocket; backlog = SOMAXCONN)"><wbr />listen<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#bindAddr%2CAsyncSocket%2Cstring"
    title="bindAddr(socket: AsyncSocket; port = Port(0); address = &quot;&quot;)"><wbr />bind<wbr />Addr<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#connectUnix%2CAsyncSocket%2Cstring"
    title="connectUnix(socket: AsyncSocket; path: string): owned(Future[void])"><wbr />connect<wbr />Unix<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#bindUnix%2CAsyncSocket%2Cstring"
    title="bindUnix(socket: AsyncSocket; path: string)"><wbr />bind<wbr />Unix<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#close%2CAsyncSocket"
    title="close(socket: AsyncSocket)"><wbr />close<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#wrapSocket%2CSslContext%2CAsyncSocket"
    title="wrapSocket(ctx: SslContext; socket: AsyncSocket)"><wbr />wrap<wbr />Socket<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#wrapConnectedSocket%2CSslContext%2CAsyncSocket%2CSslHandshakeType%2Cstring"
    title="wrapConnectedSocket(ctx: SslContext; socket: AsyncSocket;
                    handshake: SslHandshakeType; hostname: string = &quot;&quot;)"><wbr />wrap<wbr />Connected<wbr />Socket<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#getPeerCertificates%2CAsyncSocket"
    title="getPeerCertificates(socket: AsyncSocket): seq[Certificate]"><wbr />get<wbr />Peer<wbr />Certificates<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#getSockOpt%2CAsyncSocket%2CSOBool"
    title="getSockOpt(socket: AsyncSocket; opt: SOBool; level = SOL_SOCKET): bool"><wbr />get<wbr />Sock<wbr />Opt<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#setSockOpt%2CAsyncSocket%2CSOBool%2Cbool"
    title="setSockOpt(socket: AsyncSocket; opt: SOBool; value: bool; level = SOL_SOCKET)"><wbr />set<wbr />Sock<wbr />Opt<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#isSsl%2CAsyncSocket"
    title="isSsl(socket: AsyncSocket): bool"><wbr />is<wbr />Ssl<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#getFd%2CAsyncSocket"
    title="getFd(socket: AsyncSocket): SocketHandle"><wbr />get<wbr />Fd<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#isClosed%2CAsyncSocket"
    title="isClosed(socket: AsyncSocket): bool"><wbr />is<wbr />Closed<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#sendTo%2CAsyncSocket%2Cstring%2CPort%2Cstring"
    title="sendTo(socket: AsyncSocket; address: string; port: Port; data: string;
       flags = {SafeDisconn}): owned(Future[void])"><wbr />send<wbr />To<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recvFrom%2CAsyncSocket%2CFutureVar%5Bstring%5D%2Cint%2CFutureVar%5Bstring%5D%2CFutureVar%5BPort%5D"
    title="recvFrom(socket: AsyncSocket; data: FutureVar[string]; size: int;
         address: FutureVar[string]; port: FutureVar[Port]; flags = {SafeDisconn}): owned(
    Future[int])"><wbr />recv<wbr />From<span class="attachedType">AsyncSocket</span></a></li>
  <li><a class="reference" href="#recvFrom%2CAsyncSocket%2Cint"
    title="recvFrom(socket: AsyncSocket; size: int; flags = {SafeDisconn}): owned(
    Future[tuple[data: string, address: string, port: Port]])"><wbr />recv<wbr />From<span class="attachedType">AsyncSocket</span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#19" id="69">Exports</a>
  <ul class="simple simple-toc-section">
    
  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc">This module implements a high-level asynchronous sockets API based on the asynchronous dispatcher defined in the <tt class="docutils literal"><span class="pre">asyncdispatch</span></tt> module.
<h1><a class="toc-backref" id="asynchronous-io-in-nim" href="#asynchronous-io-in-nim">Asynchronous IO in Nim</a></h1><p>Async IO in Nim consists of multiple layers (from highest to lowest):</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">asyncnet</span></tt> module</li>
<li>Async await</li>
<li><tt class="docutils literal"><span class="pre">asyncdispatch</span></tt> module (event loop)</li>
<li><tt class="docutils literal"><span class="pre">selectors</span></tt> module</li>
</ul>
<p>Each builds on top of the layers below it. The selectors module is an abstraction for the various system <tt class="docutils literal"><span class="pre">select()</span></tt> mechanisms such as epoll or kqueue. If you wish you can use it directly, and some people have done so <a class="reference external" href="http://goran.krampe.se/2014/10/25/nim-socketserver/">successfully</a>. But you must be aware that on Windows it only supports <tt class="docutils literal"><span class="pre">select()</span></tt>.</p>
<p>The async dispatcher implements the proactor pattern and also has an implementation of IOCP. It implements the proactor pattern for other OS' via the selectors module. Futures are also implemented here, and indeed all the procedures return a future.</p>
<p>The final layer is the async await transformation. This allows you to write asynchronous code in a synchronous style and works similar to C#'s await. The transformation works by converting any async procedures into an iterator.</p>
<p>This is all single threaded, fully non-blocking and does give you a lot of control. In theory you should be able to work with any of these layers interchangeably (as long as you only care about non-Windows platforms).</p>
<p>For most applications using <tt class="docutils literal"><span class="pre">asyncnet</span></tt> is the way to go as it builds over all the layers, providing some extra features such as buffering.</p>
<p>SSL ===</p>
<p>SSL can be enabled by compiling with the <tt class="docutils literal"><span class="pre">-d:ssl</span></tt> flag.</p>
<p>You must create a new SSL context with the <tt class="docutils literal"><span class="pre">newContext</span></tt> function defined in the <tt class="docutils literal"><span class="pre">net</span></tt> module. You may then call <tt class="docutils literal"><span class="pre">wrapSocket</span></tt> on your socket using the newly created SSL context to get an SSL socket.</p>

<h1><a class="toc-backref" id="examples" href="#examples">Examples</a></h1>
<h2><a class="toc-backref" id="examples-chat-server" href="#examples-chat-server">Chat server</a></h2><p>The following example demonstrates a simple chat server.</p>
<pre class="listing"><span class="Keyword">import</span> <span class="Identifier">asyncnet</span><span class="Punctuation">,</span> <span class="Identifier">asyncdispatch</span>

<span class="Keyword">var</span> <span class="Identifier">clients</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">threadvar</span><span class="Operator">.</span><span class="Punctuation">}</span><span class="Punctuation">:</span> <span class="Identifier">seq</span><span class="Punctuation">[</span><span class="Identifier">AsyncSocket</span><span class="Punctuation">]</span>

<span class="Keyword">proc</span> <span class="Identifier">processClient</span><span class="Punctuation">(</span><span class="Identifier">client</span><span class="Punctuation">:</span> <span class="Identifier">AsyncSocket</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">async</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Keyword">while</span> <span class="Identifier">true</span><span class="Punctuation">:</span>
    <span class="Keyword">let</span> <span class="Identifier">line</span> <span class="Operator">=</span> <span class="Identifier">await</span> <span class="Identifier">client</span><span class="Operator">.</span><span class="Identifier">recvLine</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
    <span class="Keyword">if</span> <span class="Identifier">line</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Operator">==</span> <span class="DecNumber">0</span><span class="Punctuation">:</span> <span class="Keyword">break</span>
    <span class="Keyword">for</span> <span class="Identifier">c</span> <span class="Keyword">in</span> <span class="Identifier">clients</span><span class="Punctuation">:</span>
      <span class="Identifier">await</span> <span class="Identifier">c</span><span class="Operator">.</span><span class="Identifier">send</span><span class="Punctuation">(</span><span class="Identifier">line</span> <span class="Operator">&amp;</span> <span class="StringLit">&quot;</span><span class="EscapeSequence">\c</span><span class="EscapeSequence">\L</span><span class="StringLit">&quot;</span><span class="Punctuation">)</span>

<span class="Keyword">proc</span> <span class="Identifier">serve</span><span class="Punctuation">(</span><span class="Punctuation">)</span> <span class="Punctuation">{</span><span class="Operator">.</span><span class="Identifier">async</span><span class="Operator">.</span><span class="Punctuation">}</span> <span class="Operator">=</span>
  <span class="Identifier">clients</span> <span class="Operator">=</span> <span class="Operator">@</span><span class="Punctuation">[</span><span class="Punctuation">]</span>
  <span class="Keyword">var</span> <span class="Identifier">server</span> <span class="Operator">=</span> <span class="Identifier">newAsyncSocket</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
  <span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">setSockOpt</span><span class="Punctuation">(</span><span class="Identifier">OptReuseAddr</span><span class="Punctuation">,</span> <span class="Identifier">true</span><span class="Punctuation">)</span>
  <span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">bindAddr</span><span class="Punctuation">(</span><span class="Identifier">Port</span><span class="Punctuation">(</span><span class="DecNumber">12345</span><span class="Punctuation">)</span><span class="Punctuation">)</span>
  <span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">listen</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
  
  <span class="Keyword">while</span> <span class="Identifier">true</span><span class="Punctuation">:</span>
    <span class="Keyword">let</span> <span class="Identifier">client</span> <span class="Operator">=</span> <span class="Identifier">await</span> <span class="Identifier">server</span><span class="Operator">.</span><span class="Identifier">accept</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
    <span class="Identifier">clients</span><span class="Operator">.</span><span class="Identifier">add</span> <span class="Identifier">client</span>
    
    <span class="Identifier">asyncCheck</span> <span class="Identifier">processClient</span><span class="Punctuation">(</span><span class="Identifier">client</span><span class="Punctuation">)</span>

<span class="Identifier">asyncCheck</span> <span class="Identifier">serve</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Identifier">runForever</span><span class="Punctuation">(</span><span class="Punctuation">)</span></pre></p>
  <div class="section" id="6">
<h1><a class="toc-backref" href="#6">Imports</a></h1>
<dl class="item">
<a class="reference external" href="since.html">since</a>, <a class="reference external" href="asyncdispatch.html">asyncdispatch</a>, <a class="reference external" href="nativesockets.html">nativesockets</a>, <a class="reference external" href="net.html">net</a>, <a class="reference external" href="os.html">os</a>, <a class="reference external" href="openssl.html">openssl</a>
</dl></div>
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="AsyncSocket"></a>
<dt><pre><a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a> <span class="Other">=</span> <span class="Keyword">ref</span> <span class="Identifier">AsyncSocketDesc</span></pre></dt>
<dd>


&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L129"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L129" class="link-seesrc" target="_blank" >Edit</a>

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="newAsyncSocket,AsyncFD,Domain,SockType,Protocol"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#newAsyncSocket%2CAsyncFD%2CDomain%2CSockType%2CProtocol"><span class="Identifier">newAsyncSocket</span></a><span class="Other">(</span><span class="Identifier">fd</span><span class="Other">:</span> <a href="asyncdispatch.html#AsyncFD"><span class="Identifier">AsyncFD</span></a><span class="Other">;</span> <span class="Identifier">domain</span><span class="Other">:</span> <a href="nativesockets.html#Domain"><span class="Identifier">Domain</span></a> <span class="Other">=</span> <span class="Identifier">AF_INET</span><span class="Other">;</span>
                   <span class="Identifier">sockType</span><span class="Other">:</span> <a href="nativesockets.html#SockType"><span class="Identifier">SockType</span></a> <span class="Other">=</span> <span class="Identifier">SOCK_STREAM</span><span class="Other">;</span>
                   <span class="Identifier">protocol</span><span class="Other">:</span> <a href="nativesockets.html#Protocol"><span class="Identifier">Protocol</span></a> <span class="Other">=</span> <span class="Identifier">IPPROTO_TCP</span><span class="Other">;</span> <span class="Identifier">buffered</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">;</span>
                   <span class="Identifier">inheritable</span> <span class="Other">=</span> <span class="Identifier">defined</span><span class="Other">(</span><span class="Identifier">nimInheritHandles</span><span class="Other">)</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><span class="Identifier">AsyncSocket</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Creates a new <tt class="docutils literal"><span class="pre">AsyncSocket</span></tt> based on the supplied params.</p>
<p>The supplied <tt class="docutils literal"><span class="pre">fd</span></tt>'s non-blocking state will be enabled implicitly.</p>
<p>If <tt class="docutils literal"><span class="pre">inheritable</span></tt> is false (the default), the supplied <tt class="docutils literal"><span class="pre">fd</span></tt> will not be inheritable by child processes.</p>
<p><strong>Note</strong>: This procedure will <strong>NOT</strong> register <tt class="docutils literal"><span class="pre">fd</span></tt> with the global async dispatcher. You need to do this manually. If you have used <tt class="docutils literal"><span class="pre">newAsyncNativeSocket</span></tt> to create <tt class="docutils literal"><span class="pre">fd</span></tt> then it's already registered.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L131"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L131" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="newAsyncSocket,Domain,SockType,Protocol"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#newAsyncSocket%2CDomain%2CSockType%2CProtocol"><span class="Identifier">newAsyncSocket</span></a><span class="Other">(</span><span class="Identifier">domain</span><span class="Other">:</span> <a href="nativesockets.html#Domain"><span class="Identifier">Domain</span></a> <span class="Other">=</span> <span class="Identifier">AF_INET</span><span class="Other">;</span> <span class="Identifier">sockType</span><span class="Other">:</span> <a href="nativesockets.html#SockType"><span class="Identifier">SockType</span></a> <span class="Other">=</span> <span class="Identifier">SOCK_STREAM</span><span class="Other">;</span>
                   <span class="Identifier">protocol</span><span class="Other">:</span> <a href="nativesockets.html#Protocol"><span class="Identifier">Protocol</span></a> <span class="Other">=</span> <span class="Identifier">IPPROTO_TCP</span><span class="Other">;</span> <span class="Identifier">buffered</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">;</span>
                   <span class="Identifier">inheritable</span> <span class="Other">=</span> <span class="Identifier">defined</span><span class="Other">(</span><span class="Identifier">nimInheritHandles</span><span class="Other">)</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><span class="Identifier">AsyncSocket</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Creates a new asynchronous socket.</p>
<p>This procedure will also create a brand new file descriptor for this socket.</p>
<p>If <tt class="docutils literal"><span class="pre">inheritable</span></tt> is false (the default), the new file descriptor will not be inheritable by child processes.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L159"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L159" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="getLocalAddr,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getLocalAddr%2CAsyncSocket"><span class="Identifier">getLocalAddr</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">,</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Get the socket's local address and port number.</p>
<p>This is high-level interface for <span id="getsockname_1">getsockname</span>.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L174"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L174" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="getPeerAddr,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getPeerAddr%2CAsyncSocket"><span class="Identifier">getPeerAddr</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">,</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Get the socket's peer address and port number.</p>
<p>This is high-level interface for <span id="getpeername_1">getpeername</span>.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L180"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L180" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="newAsyncSocket,cint,cint,cint"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#newAsyncSocket%2Ccint%2Ccint%2Ccint"><span class="Identifier">newAsyncSocket</span></a><span class="Other">(</span><span class="Identifier">domain</span><span class="Other">,</span> <span class="Identifier">sockType</span><span class="Other">,</span> <span class="Identifier">protocol</span><span class="Other">:</span> <a href="system.html#cint"><span class="Identifier">cint</span></a><span class="Other">;</span> <span class="Identifier">buffered</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">;</span>
                   <span class="Identifier">inheritable</span> <span class="Other">=</span> <span class="Identifier">defined</span><span class="Other">(</span><span class="Identifier">nimInheritHandles</span><span class="Other">)</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><span class="Identifier">AsyncSocket</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">,</span> <span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Creates a new asynchronous socket.</p>
<p>This procedure will also create a brand new file descriptor for this socket.</p>
<p>If <tt class="docutils literal"><span class="pre">inheritable</span></tt> is false (the default), the new file descriptor will not be inheritable by child processes.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L186"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L186" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="dial,string,Port"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#dial%2Cstring%2CPort"><span class="Identifier">dial</span></a><span class="Other">(</span><span class="Identifier">address</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">;</span> <span class="Identifier">protocol</span> <span class="Other">=</span> <span class="Identifier">IPPROTO_TCP</span><span class="Other">;</span> <span class="Identifier">buffered</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Establishes connection to the specified <tt class="docutils literal"><span class="pre">address</span></tt>:<tt class="docutils literal"><span class="pre">port</span></tt> pair via the specified protocol. The procedure iterates through possible resolutions of the <tt class="docutils literal"><span class="pre">address</span></tt> until it succeeds, meaning that it seamlessly works with both IPv4 and IPv6. Returns AsyncSocket ready to send or receive data.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L280"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L280" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="connect,AsyncSocket,string,Port"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#connect%2CAsyncSocket%2Cstring%2CPort"><span class="Identifier">connect</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">address</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Connects <tt class="docutils literal"><span class="pre">socket</span></tt> to server at <tt class="docutils literal"><span class="pre">address:port</span></tt>.</p>
<p>Returns a <tt class="docutils literal"><span class="pre">Future</span></tt> which will complete when the connection succeeds or an error occurs.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L291"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L291" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recvInto,AsyncSocket,pointer,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recvInto%2CAsyncSocket%2Cpointer%2Cint"><span class="Identifier">recvInto</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">buf</span><span class="Other">:</span> <a href="system.html#pointer"><span class="Identifier">pointer</span></a><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Reads <strong>up to</strong> <tt class="docutils literal"><span class="pre">size</span></tt> bytes from <tt class="docutils literal"><span class="pre">socket</span></tt> into <tt class="docutils literal"><span class="pre">buf</span></tt>.</p>
<p>For buffered sockets this function will attempt to read all the requested data. It will read this data in <tt class="docutils literal"><span class="pre">BufferSize</span></tt> chunks.</p>
<p>For unbuffered sockets this function makes no effort to read all the data requested. It will return as much data as the operating system gives it.</p>
<p>If socket is disconnected during the recv operation then the future may complete with only a part of the requested data.</p>
<p>If socket is disconnected and no data is available to be read then the future will complete with a value of <tt class="docutils literal"><span class="pre">0</span></tt>.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L335"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L335" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recv,AsyncSocket,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recv%2CAsyncSocket%2Cint"><span class="Identifier">recv</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Reads <strong>up to</strong> <tt class="docutils literal"><span class="pre">size</span></tt> bytes from <tt class="docutils literal"><span class="pre">socket</span></tt>.</p>
<p>For buffered sockets this function will attempt to read all the requested data. It will read this data in <tt class="docutils literal"><span class="pre">BufferSize</span></tt> chunks.</p>
<p>For unbuffered sockets this function makes no effort to read all the data requested. It will return as much data as the operating system gives it.</p>
<p>If socket is disconnected during the recv operation then the future may complete with only a part of the requested data.</p>
<p>If socket is disconnected and no data is available to be read then the future will complete with a value of <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L383"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L383" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="send,AsyncSocket,pointer,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#send%2CAsyncSocket%2Cpointer%2Cint"><span class="Identifier">send</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">buf</span><span class="Other">:</span> <a href="system.html#pointer"><span class="Identifier">pointer</span></a><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Sends <tt class="docutils literal"><span class="pre">size</span></tt> bytes from <tt class="docutils literal"><span class="pre">buf</span></tt> to <tt class="docutils literal"><span class="pre">socket</span></tt>. The returned future will complete once all data has been sent.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L435"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L435" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="send,AsyncSocket,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#send%2CAsyncSocket%2Cstring"><span class="Identifier">send</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Sends <tt class="docutils literal"><span class="pre">data</span></tt> to <tt class="docutils literal"><span class="pre">socket</span></tt>. The returned future will complete once all data has been sent.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L449"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L449" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="acceptAddr,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#acceptAddr%2CAsyncSocket"><span class="Identifier">acceptAddr</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">;</span>
               <span class="Identifier">inheritable</span> <span class="Other">=</span> <span class="Identifier">defined</span><span class="Other">(</span><span class="Identifier">nimInheritHandles</span><span class="Other">)</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">address</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">,</span> <span class="Identifier">client</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">]</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Accepts a new connection. Returns a future containing the client socket corresponding to that connection and the remote address of the client.</p>
<p>If <tt class="docutils literal"><span class="pre">inheritable</span></tt> is false (the default), the resulting client socket will not be inheritable by child processes.</p>
<p>The future will complete when the connection is successfully accepted.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L462"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L462" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="accept,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#accept%2CAsyncSocket"><span class="Identifier">accept</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Accepts a new connection. Returns a future containing the client socket corresponding to that connection. If <tt class="docutils literal"><span class="pre">inheritable</span></tt> is false (the default), the resulting client socket will not be inheritable by child processes. The future will complete when the connection is successfully accepted.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L486"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L486" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recvLineInto,AsyncSocket,FutureVar[string]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recvLineInto%2CAsyncSocket%2CFutureVar%5Bstring%5D"><span class="Identifier">recvLineInto</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">resString</span><span class="Other">:</span> <a href="asyncfutures.html#FutureVar"><span class="Identifier">FutureVar</span></a><span class="Other">[</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">]</span><span class="Other">;</span>
                 <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">;</span> <span class="Identifier">maxLength</span> <span class="Other">=</span> <span class="Identifier">MaxLineLength</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Reads a line of data from <tt class="docutils literal"><span class="pre">socket</span></tt> into <tt class="docutils literal"><span class="pre">resString</span></tt>.</p>
<p>If a full line is read <tt class="docutils literal"><span class="pre">\r\L</span></tt> is not added to <tt class="docutils literal"><span class="pre">line</span></tt>, however if solely <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read then <tt class="docutils literal"><span class="pre">line</span></tt> will be set to it.</p>
<p>If the socket is disconnected, <tt class="docutils literal"><span class="pre">line</span></tt> will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>.</p>
<p>If the socket is disconnected in the middle of a line (before <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read) then line will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>. The partial line <strong>will be lost</strong>.</p>
<p>The <tt class="docutils literal"><span class="pre">maxLength</span></tt> parameter determines the maximum amount of characters that can be read. <tt class="docutils literal"><span class="pre">resString</span></tt> will be truncated after that.</p>
<p><strong>Warning</strong>: The <tt class="docutils literal"><span class="pre">Peek</span></tt> flag is not yet implemented.</p>
<p><strong>Warning</strong>: <tt class="docutils literal"><span class="pre">recvLineInto</span></tt> on unbuffered sockets assumes that the protocol uses <tt class="docutils literal"><span class="pre">\r\L</span></tt> to delimit a new line.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L505"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L505" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recvLine,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recvLine%2CAsyncSocket"><span class="Identifier">recvLine</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">;</span> <span class="Identifier">maxLength</span> <span class="Other">=</span> <span class="Identifier">MaxLineLength</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Reads a line of data from <tt class="docutils literal"><span class="pre">socket</span></tt>. Returned future will complete once a full line is read or an error occurs.</p>
<p>If a full line is read <tt class="docutils literal"><span class="pre">\r\L</span></tt> is not added to <tt class="docutils literal"><span class="pre">line</span></tt>, however if solely <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read then <tt class="docutils literal"><span class="pre">line</span></tt> will be set to it.</p>
<p>If the socket is disconnected, <tt class="docutils literal"><span class="pre">line</span></tt> will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>.</p>
<p>If the socket is disconnected in the middle of a line (before <tt class="docutils literal"><span class="pre">\r\L</span></tt> is read) then line will be set to <tt class="docutils literal"><span class="pre">&quot;&quot;</span></tt>. The partial line <strong>will be lost</strong>.</p>
<p>The <tt class="docutils literal"><span class="pre">maxLength</span></tt> parameter determines the maximum amount of characters that can be read. The result is truncated after that.</p>
<p><strong>Warning</strong>: The <tt class="docutils literal"><span class="pre">Peek</span></tt> flag is not yet implemented.</p>
<p><strong>Warning</strong>: <tt class="docutils literal"><span class="pre">recvLine</span></tt> on unbuffered sockets assumes that the protocol uses <tt class="docutils literal"><span class="pre">\r\L</span></tt> to delimit a new line.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L598"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L598" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="listen,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#listen%2CAsyncSocket"><span class="Identifier">listen</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">backlog</span> <span class="Other">=</span> <span class="Identifier">SOMAXCONN</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="system.html#ReadIOEffect"><span class="Identifier">ReadIOEffect</span></a><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Marks <tt class="docutils literal"><span class="pre">socket</span></tt> as accepting connections. <tt class="docutils literal"><span class="pre">Backlog</span></tt> specifies the maximum length of the queue of pending connections.</p>
<p>Raises an OSError error upon failure.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L627"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L627" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="bindAddr,AsyncSocket,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#bindAddr%2CAsyncSocket%2Cstring"><span class="Identifier">bindAddr</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">port</span> <span class="Other">=</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">(</span><span class="DecNumber">0</span><span class="Other">)</span><span class="Other">;</span> <span class="Identifier">address</span> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="system.html#ReadIOEffect"><span class="Identifier">ReadIOEffect</span></a><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">OSError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Binds <tt class="docutils literal"><span class="pre">address</span></tt>:<tt class="docutils literal"><span class="pre">port</span></tt> to the socket.</p>
<p>If <tt class="docutils literal"><span class="pre">address</span></tt> is &quot;&quot; then ADDR_ANY will be bound.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L636"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L636" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="connectUnix,AsyncSocket,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#connectUnix%2CAsyncSocket%2Cstring"><span class="Identifier">connectUnix</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">path</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Binds Unix socket to <tt class="docutils literal"><span class="pre">path</span></tt>. This only works on Unix-style systems: Mac OS X, BSD and Linux
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L658"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L658" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="bindUnix,AsyncSocket,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#bindUnix%2CAsyncSocket%2Cstring"><span class="Identifier">bindUnix</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">path</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="system.html#ReadIOEffect"><span class="Identifier">ReadIOEffect</span></a><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Binds Unix socket to <tt class="docutils literal"><span class="pre">path</span></tt>. This only works on Unix-style systems: Mac OS X, BSD and Linux
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L689"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L689" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="close,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#close%2CAsyncSocket"><span class="Identifier">close</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">,</span> <span class="Identifier">SslError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Closes the socket.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L711"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L711" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="wrapSocket,SslContext,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#wrapSocket%2CSslContext%2CAsyncSocket"><span class="Identifier">wrapSocket</span></a><span class="Other">(</span><span class="Identifier">ctx</span><span class="Other">:</span> <a href="net.html#SslContext"><span class="Identifier">SslContext</span></a><span class="Other">;</span> <span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">SslError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Wraps a socket in an SSL context. This function effectively turns <tt class="docutils literal"><span class="pre">socket</span></tt> into an SSL socket.</p>
<p><strong>Disclaimer</strong>: This code is not well tested, may be very unsafe and prone to security vulnerabilities.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L734"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L734" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="wrapConnectedSocket,SslContext,AsyncSocket,SslHandshakeType,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#wrapConnectedSocket%2CSslContext%2CAsyncSocket%2CSslHandshakeType%2Cstring"><span class="Identifier">wrapConnectedSocket</span></a><span class="Other">(</span><span class="Identifier">ctx</span><span class="Other">:</span> <a href="net.html#SslContext"><span class="Identifier">SslContext</span></a><span class="Other">;</span> <span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span>
                        <span class="Identifier">handshake</span><span class="Other">:</span> <a href="net.html#SslHandshakeType"><span class="Identifier">SslHandshakeType</span></a><span class="Other">;</span> <span class="Identifier">hostname</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a> <span class="Other">=</span> <span class="StringLit">&quot;&quot;</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">SslError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Wraps a connected socket in an SSL context. This function effectively turns <tt class="docutils literal"><span class="pre">socket</span></tt> into an SSL socket. <tt class="docutils literal"><span class="pre">hostname</span></tt> should be specified so that the client knows which hostname the server certificate should be validated against.</p>
<p>This should be called on a connected socket, and will perform an SSL handshake immediately.</p>
<p><strong>Disclaimer</strong>: This code is not well tested, may be very unsafe and prone to security vulnerabilities.</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L750"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L750" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="getPeerCertificates,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getPeerCertificates%2CAsyncSocket"><span class="Identifier">getPeerCertificates</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <a href="system.html#seq"><span class="Identifier">seq</span></a><span class="Other">[</span><a href="net.html#Certificate"><span class="Identifier">Certificate</span></a><span class="Other">]</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns the certificate chain received by the peer we are connected to through the given socket. The handshake must have been completed and the certificate chain must have been verified successfully or else an empty sequence is returned. The chain is ordered from leaf certificate to root certificate.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L775"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L775" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="getSockOpt,AsyncSocket,SOBool"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getSockOpt%2CAsyncSocket%2CSOBool"><span class="Identifier">getSockOpt</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">opt</span><span class="Other">:</span> <a href="net.html#SOBool"><span class="Identifier">SOBool</span></a><span class="Other">;</span> <span class="Identifier">level</span> <span class="Other">=</span> <span class="Identifier">SOL_SOCKET</span><span class="Other">)</span><span class="Other">:</span> <a href="system.html#bool"><span class="Identifier">bool</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="system.html#ReadIOEffect"><span class="Identifier">ReadIOEffect</span></a><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Retrieves option <tt class="docutils literal"><span class="pre">opt</span></tt> as a boolean value.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L786"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L786" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="setSockOpt,AsyncSocket,SOBool,bool"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#setSockOpt%2CAsyncSocket%2CSOBool%2Cbool"><span class="Identifier">setSockOpt</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">opt</span><span class="Other">:</span> <a href="net.html#SOBool"><span class="Identifier">SOBool</span></a><span class="Other">;</span> <span class="Identifier">value</span><span class="Other">:</span> <a href="system.html#bool"><span class="Identifier">bool</span></a><span class="Other">;</span> <span class="Identifier">level</span> <span class="Other">=</span> <span class="Identifier">SOL_SOCKET</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><a href="system.html#WriteIOEffect"><span class="Identifier">WriteIOEffect</span></a><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">OSError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Sets option <tt class="docutils literal"><span class="pre">opt</span></tt> to a boolean value specified by <tt class="docutils literal"><span class="pre">value</span></tt>.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L792"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L792" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="isSsl,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#isSsl%2CAsyncSocket"><span class="Identifier">isSsl</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <a href="system.html#bool"><span class="Identifier">bool</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Determines whether <tt class="docutils literal"><span class="pre">socket</span></tt> is a SSL socket.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L798"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L798" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="getFd,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#getFd%2CAsyncSocket"><span class="Identifier">getFd</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <a href="winlean.html#SocketHandle"><span class="Identifier">SocketHandle</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Returns the socket's file descriptor.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L802"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L802" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="isClosed,AsyncSocket"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#isClosed%2CAsyncSocket"><span class="Identifier">isClosed</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">)</span><span class="Other">:</span> <a href="system.html#bool"><span class="Identifier">bool</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Determines whether the socket has been closed.
&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L806"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L806" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="sendTo,AsyncSocket,string,Port,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#sendTo%2CAsyncSocket%2Cstring%2CPort%2Cstring"><span class="Identifier">sendTo</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">address</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">;</span>
           <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#void"><span class="Identifier">void</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>This proc sends <tt class="docutils literal"><span class="pre">data</span></tt> to the specified <tt class="docutils literal"><span class="pre">address</span></tt>, which may be an IP address or a hostname. If a hostname is specified this function will try each IP of that hostname. The returned future will complete once all data has been sent.</p>
<p>If an error occurs an OSError exception will be raised.</p>
<p>This proc is normally used with connectionless sockets (UDP sockets).</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L812"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L812" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recvFrom,AsyncSocket,FutureVar[string],int,FutureVar[string],FutureVar[Port]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recvFrom%2CAsyncSocket%2CFutureVar%5Bstring%5D%2Cint%2CFutureVar%5Bstring%5D%2CFutureVar%5BPort%5D"><span class="Identifier">recvFrom</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">data</span><span class="Other">:</span> <a href="asyncfutures.html#FutureVar"><span class="Identifier">FutureVar</span></a><span class="Other">[</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">;</span>
             <span class="Identifier">address</span><span class="Other">:</span> <a href="asyncfutures.html#FutureVar"><span class="Identifier">FutureVar</span></a><span class="Other">[</span><a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">port</span><span class="Other">:</span> <a href="asyncfutures.html#FutureVar"><span class="Identifier">FutureVar</span></a><span class="Other">[</span><a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">]</span><span class="Other">;</span>
             <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span><a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Receives a datagram data from <tt class="docutils literal"><span class="pre">socket</span></tt> into <tt class="docutils literal"><span class="pre">data</span></tt>, which must be at least of size <tt class="docutils literal"><span class="pre">size</span></tt>. The address and port of datagram's sender will be stored into <tt class="docutils literal"><span class="pre">address</span></tt> and <tt class="docutils literal"><span class="pre">port</span></tt>, respectively. Returned future will complete once one datagram has been received, and will return size of packet received.</p>
<p>If an error occurs an OSError exception will be raised.</p>
<p>This proc is normally used with connectionless sockets (UDP sockets).</p>
<p><strong>Notes</strong></p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">data</span></tt> must be initialized to the length of <tt class="docutils literal"><span class="pre">size</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">address</span></tt> must be initialized to 46 in length.</li>
</ul>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L859"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L859" class="link-seesrc" target="_blank" >Edit</a>

</dd>
<a id="recvFrom,AsyncSocket,int"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#recvFrom%2CAsyncSocket%2Cint"><span class="Identifier">recvFrom</span></a><span class="Other">(</span><span class="Identifier">socket</span><span class="Other">:</span> <a href="asyncnet.html#AsyncSocket"><span class="Identifier">AsyncSocket</span></a><span class="Other">;</span> <span class="Identifier">size</span><span class="Other">:</span> <a href="system.html#int"><span class="Identifier">int</span></a><span class="Other">;</span> <span class="Identifier">flags</span> <span class="Other">=</span> <span class="Other">{</span><span class="Identifier">SafeDisconn</span><span class="Other">}</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">owned</span><span class="Other">(</span>
    <a href="asyncfutures.html#Future"><span class="Identifier">Future</span></a><span class="Other">[</span><span class="Keyword">tuple</span><span class="Other">[</span><span class="Identifier">data</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">,</span> <span class="Identifier">address</span><span class="Other">:</span> <a href="system.html#string"><span class="Identifier">string</span></a><span class="Other">,</span> <span class="Identifier">port</span><span class="Other">:</span> <a href="nativesockets.html#Port"><span class="Identifier">Port</span></a><span class="Other">]</span><span class="Other">]</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">Exception</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">RootEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Receives a datagram data from <tt class="docutils literal"><span class="pre">socket</span></tt>, which must be at least of size <tt class="docutils literal"><span class="pre">size</span></tt>. Returned future will complete once one datagram has been received and will return tuple with: data of packet received; and address and port of datagram's sender.</p>
<p>If an error occurs an OSError exception will be raised.</p>
<p>This proc is normally used with connectionless sockets (UDP sockets).</p>

&nbsp;&nbsp;<a
href="https://github.com/nim-lang/Nim/tree/devel/lib/pure/asyncnet.nim#L913"
class="link-seesrc" target="_blank">Source</a>
<a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncnet.nim#L913" class="link-seesrc" target="_blank" >Edit</a>

</dd>

</dl></div>
<div class="section" id="19">
<h1><a class="toc-backref" href="#19">Exports</a></h1>
<dl class="item">
<a href="net.html#SOBool"><span class="Identifier">SOBool</span></a>
</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim. Generated: 2020-07-24 00:51:26 UTC</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
